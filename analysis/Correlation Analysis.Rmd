---
title: "Correlation Analysis"
output:
  pdf_document: default
---

We will begin our analysis of the 2024 NBA player statistics by exploring the correlation among the variables we have within this data set.
Correlation analysis helps us see which statistics tend to move together and which ones behave independently. This gives us a clearer picture of how different parts of a player’s game relate to one another and helps identify which variables might be redundant or telling the same story.


We begin by loading in our cleaned dataset that we have saved within our repository.
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)

# Load cleaned dataset
load(here::here("data", "nba2024_cleaned.RData"))

# Load required libraries
source(here::here("00_requirements.R"))
```



We first take a quick look at the structure of our cleaned dataset.

```{r}
dim(clean_data)
names(clean_data)
str(clean_data)
```

We will now select the variables of interest we would like to explore. To reduce visual clutter and multicollinearity, variables that were highly redundant or not performance-based were removed from the correlation analysis. Offensive and defensive rebounding metrics were replaced by total rebounds, individual shot types were summarized by total field goal attempts, and only two efficiency metrics were retained (FG% and eFG%)

```{r}
# Variables we want to examine (edit names as needed)
vars <- c(
  # Performance
  "PTS", "TRB", "AST", "STL", "BLK", "TOV", "PF", 
  
  # Volume
  "MP", "FGA", "FTA",
  
  # Efficiency 
  "FG_pct", "X3P_pct", "X2P_pct", "FT_pct", "eFG.",
  
  # Age(While not a performance statistics, would still like to explore if there is any correlation between increasing age with these other variables)
  "Age"
)
```




We now will subset these variables of interest and ensure that we only keep numeric columns so that it is ready to compute a correlation matrix.
```{r}
stats <- clean_data[ , vars, drop = FALSE]

is_num <- sapply(stats, is.numeric)
stats_num <- stats[ , is_num, drop = FALSE]
str(stats_num)
```

We then compute the correlation matrix for these selected variables.
```{r}
cor_mat <- cor(stats_num, use = "pairwise.complete.obs")
round(cor_mat, 2)
```
Using corrplot we will create a correlation heatmap for the selected variables of interest.

```{r corrplot-visual, fig.width=10, fig.height=10}
corrplot(
  cor_mat,
  method = "circle",      # color tiles
  type   = "upper",      # show upper triangle only
  order  = "hclust",     # cluster similar variables
  addCoef.col = "black", # add correlation coefficients
  tl.cex = 0.8           # label size-±
)
```

Correlation Heatmap:
The correlation heatmap gives a quick visual summary of how the main performance stats relate to each other. Larger, darker circles show stronger relationships.
A few patterns stand out:
Scoring and shooting volume go together.
Points (PTS) are very closely tied to field-goal attempts (FGA) and free-throw attempts (FTA). This makes sense as players who take more shots usually score more.
Rebounding and blocking are connected.
Total rebounds (TRB) and blocks (BLK) show a strong positive relationship, showing that interior players tend to contribute in both areas.
Assists (AST) and turnovers (TOV) rise together. Players who handle the ball more create more plays but also commit more turnovers.
Efficiency stats cluster together.
FG%, eFG%, and 2-point percentage are all closely related, which is expected since they measure similar aspects of shooting ability.
Age has almost no strong correlations with the other variables. This supports the idea that older players can still perform at a high level such as Lebron James as seen in the league today.
Overall, the heatmap helps us see how NBA stats naturally group together: usage stats (PTS, FGA, AST, TOV) form one cluster, interior stats (TRB, BLK) form another, and shooting efficiency stands on its own.

```{r pair-plots, fig.width=10, fig.height=10}



pair_vars <- c(
  "PTS",     # Scoring
  "AST",     # Playmaking
  "TRB",     # Rebounding
  "STL",     # On-ball defense
  "BLK",     # Rim defense
  "FG_pct",  # Shooting efficiency
  "eFG.",    # Adjusted efficiency
  "TOV"      # Turn overs
)

pair_vars <- intersect(pair_vars, colnames(stats_num))  # safety check

```

```{r, warning=FALSE, message=FALSE}
    ggpairs(
      stats_num[ , pair_vars, drop = FALSE],
      progress = FALSE
    )
```

Pair Plots (ggpairs):
The pair plots  let us zoom in on each pair of variables and see the actual scatter of points, along with simple correlations.
What we learn from these visuals:
Higher scorers tend to be more efficient.
PTS has a positive relationship with both FG% and eFG%. While high scorers shoot more, many also shoot efficiently.
Rebounders tend to block more shots.
The TRB–BLK scatterplot shows a clear upward trend, again highlighting the role of interior players.
Turnovers rise with involvement.
Players who score more, pass more, or play more minutes also turn the ball over more. This reflects how much they handle the ball.
Stat distributions are skewed.
The density curves show that only a small number of players get very high numbers in stats like PTS, AST, and BLK, which matches what we see in real NBA performance.

 

Overall Takeaways:

These visualizations help us quickly understand how NBA player stats relate to each other:
Usage-heavy players accumulate both high positive (PTS, AST) and negative (TOV) stats.
Interior players stand out in TRB and BLK.
Shooting efficiency forms its own separate group.
Age doesn’t strongly shape performance in this dataset.

