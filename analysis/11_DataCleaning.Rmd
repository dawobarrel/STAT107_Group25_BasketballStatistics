---
title: "Cleaning Data"
output: html_document
date: "2025-11-07"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


Using our 00_requirements.R we will load in all needed packages.
```{r setup}
source(here::here("00_requirements.R"))
```



Load in the CSV file via url from GitHub Repository.

```{r}
raw_data <- read.csv("https://raw.githubusercontent.com/dawobarrel/STAT107_Group25_BasketballStatistics/refs/heads/main/data/nba2024.csv")

```

Despite data already being cleaned we will be double checking by getting rid of any missing values and duplicates.
One thing to note in our dataset is that instead of for example 3 Pointer percantage being labeled 3P% it is labeled as "3P." So for readibility we will convert these to "3P_pct"

```{r}
clean_data <- raw_data %>%
  rename(
    X3P_pct = X3P.,
    X2P_pct = X2P.,
    FG_pct = FG.,
    FT_pct = FT.
  )


```

Throughout the NBA season certain players may have been traded to different teams, leading to our data set having saved the stats of such players under each individual team they had played for during the season. For our analysis we will be looking at the total stats of each player, so if a player had played for multiple teams we will be removing the stats they had accumulated for each individual team and leave only their total total stats throughout the season regardless of team played for.

```{r}
# Identify total rows such as 2TM, 3TM.
is_total <- grepl("^[0-9]TM$", clean_data$Team)

# Check if each player has at least one total row
has_total <- ave(is_total, clean_data$Player, FUN = any)

# Keep either:
# - total rows, OR
# - rows for players who do NOT have a total row
keep <- (!has_total) | is_total

# Overwrite clean_data
clean_data <- clean_data[keep, ]
```

To reduce instability in per game averages and remove fringe participants, we restricted the sample to players with at least 20 games played, consistent with common sports analytics practice

```{r}
clean_data <- clean_data[clean_data$G >= 20, ]
```

Now we will be double checking to make sure that our data set is ready to use for analysis.


Checking for missing values.

```{r}
# Total missing values
sum(is.na(clean_data))

# Missing values by column
colSums(is.na(clean_data))
```

The 44 Missing values as shown in the colSums output are not actually from missing data but from the calculation of percentages of statistics such as 3Pointers, as if a player has made 0 3Pointers the 3Pointer percentage would be nullas a result as there is no data to calculate this percentage resulting in these missing values. 

Checking for duplicate rows.
```{r}
# Count duplicate rows
sum(duplicated(clean_data))
```

Checking summary of statistics usin

```{r}
# Full summary of numerical variables
skimr::skim(clean_data)
```

Now that we have processed our dataset for better readability and have checked to make sure it is properly cleaned and ready for further analysis we save it so we can load it in later scripts.
```{r}
save(clean_data, file = here::here("data", "nba2024_cleaned.RData"))
```


